import{inject as t,defineComponent as e,ref as n,reactive as o,watch as r,onMounted as i,onBeforeUnmount as l,provide as a,openBlock as c,createElementBlock as u,normalizeClass as f,createElementVNode as s,createCommentVNode as d,renderSlot as v,toDisplayString as h,normalizeStyle as p,toRefs as m,getCurrentInstance as g}from"vue";const b=Symbol("PizzaConfigProvider");function y(){return t(b,{clsPrefix:"p",mode:"light"})}const x=t=>{const{clsPrefix:e}=y();return t?`${e}-${t}`:e},w=t=>(t.install=e=>{var n;e.component(`${n?.componentPrefix??"P"}${t.name}`,t)},t);var k="object"==typeof global&&global&&global.Object===Object&&global,$="object"==typeof self&&self&&self.Object===Object&&self,T=k||$||Function("return this")(),C=T.Symbol,P=Object.prototype,j=P.hasOwnProperty,S=P.toString,E=C?C.toStringTag:void 0;var R=Object.prototype.toString;var L=C?C.toStringTag:void 0;function O(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":L&&L in Object(t)?function(t){var e=j.call(t,E),n=t[E];try{t[E]=void 0;var o=!0}catch(t){}var r=S.call(t);return o&&(e?t[E]=n:delete t[E]),r}(t):function(t){return R.call(t)}(t)}function W(t){return null!=t&&"object"==typeof t}var H=Array.isArray,B=/\s/;var M=/^\s+/;function _(t){return t?t.slice(0,function(t){for(var e=t.length;e--&&B.test(t.charAt(e)););return e}(t)+1).replace(M,""):t}function A(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var N=/^[-+]0x[0-9a-f]+$/i,I=/^0b[01]+$/i,z=/^0o[0-7]+$/i,D=parseInt;function V(t){if("number"==typeof t)return t;if(function(t){return"symbol"==typeof t||W(t)&&"[object Symbol]"==O(t)}(t))return NaN;if(A(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=A(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=_(t);var n=I.test(t);return n||z.test(t)?D(t.slice(2),n?2:8):N.test(t)?NaN:+t}var X=function(){return T.Date.now()},Y=Math.max,F=Math.min;function q(t,e,n){var o,r,i,l,a,c,u=0,f=!1,s=!1,d=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function v(e){var n=o,i=r;return o=r=void 0,u=e,l=t.apply(i,n)}function h(t){return u=t,a=setTimeout(m,e),f?v(t):l}function p(t){var n=t-c;return void 0===c||n>=e||n<0||s&&t-u>=i}function m(){var t=X();if(p(t))return g(t);a=setTimeout(m,function(t){var n=e-(t-c);return s?F(n,i-(t-u)):n}(t))}function g(t){return a=void 0,d&&o?v(t):(o=r=void 0,l)}function b(){var t=X(),n=p(t);if(o=arguments,r=this,c=t,n){if(void 0===a)return h(c);if(s)return clearTimeout(a),a=setTimeout(m,e),v(c)}return void 0===a&&(a=setTimeout(m,e)),l}return e=V(e)||0,A(n)&&(f=!!n.leading,i=(s="maxWait"in n)?Y(V(n.maxWait)||0,e):i,d="trailing"in n?!!n.trailing:d),b.cancel=function(){void 0!==a&&clearTimeout(a),u=0,o=c=r=a=void 0},b.flush=function(){return void 0===a?l:g(X())},b}function U(t,e,n){var o=!0,r=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return A(n)&&(o="leading"in n?!!n.leading:o,r="trailing"in n?!!n.trailing:r),q(t,e,{leading:o,maxWait:e,trailing:r})}const G=(t,e)=>{if("string"==typeof(n=t)||!H(n)&&W(n)&&"[object String]"==O(n)){const n="#"===t[0]?`[id='${t.slice(1)}']`:t;return(e??document).querySelector(n)??void 0}var n;return t};function J(t){return"object"==typeof t&&null!=t&&1===t.nodeType}function K(t,e){return(!e||"hidden"!==t)&&"visible"!==t&&"clip"!==t}function Q(t,e){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var n=getComputedStyle(t,null);return K(n.overflowY,e)||K(n.overflowX,e)||function(t){var e=function(t){if(!t.ownerDocument||!t.ownerDocument.defaultView)return null;try{return t.ownerDocument.defaultView.frameElement}catch(t){return null}}(t);return!!e&&(e.clientHeight<t.scrollHeight||e.clientWidth<t.scrollWidth)}(t)}return!1}function Z(t,e,n,o,r,i,l,a){return i<t&&l>e||i>t&&l<e?0:i<=t&&a<=n||l>=e&&a>=n?i-t-o:l>e&&a<n||i<t&&a>n?l-e+r:0}var tt,et=function(t,e){var n=window,o=e.scrollMode,r=e.block,i=e.inline,l=e.boundary,a=e.skipOverflowHiddenElements,c="function"==typeof l?l:function(t){return t!==l};if(!J(t))throw new TypeError("Invalid target");for(var u,f,s=document.scrollingElement||document.documentElement,d=[],v=t;J(v)&&c(v);){if((v=null==(f=(u=v).parentElement)?u.getRootNode().host||null:f)===s){d.push(v);break}null!=v&&v===document.body&&Q(v)&&!Q(document.documentElement)||null!=v&&Q(v,a)&&d.push(v)}for(var h=n.visualViewport?n.visualViewport.width:innerWidth,p=n.visualViewport?n.visualViewport.height:innerHeight,m=window.scrollX||pageXOffset,g=window.scrollY||pageYOffset,b=t.getBoundingClientRect(),y=b.height,x=b.width,w=b.top,k=b.right,$=b.bottom,T=b.left,C="start"===r||"nearest"===r?w:"end"===r?$:w+y/2,P="center"===i?T+x/2:"end"===i?k:T,j=[],S=0;S<d.length;S++){var E=d[S],R=E.getBoundingClientRect(),L=R.height,O=R.width,W=R.top,H=R.right,B=R.bottom,M=R.left;if("if-needed"===o&&w>=0&&T>=0&&$<=p&&k<=h&&w>=W&&$<=B&&T>=M&&k<=H)return j;var _=getComputedStyle(E),A=parseInt(_.borderLeftWidth,10),N=parseInt(_.borderTopWidth,10),I=parseInt(_.borderRightWidth,10),z=parseInt(_.borderBottomWidth,10),D=0,V=0,X="offsetWidth"in E?E.offsetWidth-E.clientWidth-A-I:0,Y="offsetHeight"in E?E.offsetHeight-E.clientHeight-N-z:0,F="offsetWidth"in E?0===E.offsetWidth?0:O/E.offsetWidth:0,q="offsetHeight"in E?0===E.offsetHeight?0:L/E.offsetHeight:0;if(s===E)D="start"===r?C:"end"===r?C-p:"nearest"===r?Z(g,g+p,p,N,z,g+C,g+C+y,y):C-p/2,V="start"===i?P:"center"===i?P-h/2:"end"===i?P-h:Z(m,m+h,h,A,I,m+P,m+P+x,x),D=Math.max(0,D+g),V=Math.max(0,V+m);else{D="start"===r?C-W-N:"end"===r?C-B+z+Y:"nearest"===r?Z(W,B,L,N,z+Y,C,C+y,y):C-(W+L/2)+Y/2,V="start"===i?P-M-A:"center"===i?P-(M+O/2)+X/2:"end"===i?P-H+I+X:Z(M,H,O,A,I+X,P,P+x,x);var U=E.scrollLeft,G=E.scrollTop;C+=G-(D=Math.max(0,Math.min(G+D/q,E.scrollHeight-L/q+Y))),P+=U-(V=Math.max(0,Math.min(U+V/F,E.scrollWidth-O/F+X)))}j.push({el:E,top:D,left:V})}return j};function nt(t){return t===Object(t)&&0!==Object.keys(t).length}function ot(t,e){var n=t.isConnected||t.ownerDocument.documentElement.contains(t);if(nt(e)&&"function"==typeof e.behavior)return e.behavior(n?et(t,e):[]);if(n){var o=function(t){return!1===t?{block:"end",inline:"nearest"}:nt(t)?t:{block:"start",inline:"nearest"}}(e);return function(t,e){void 0===e&&(e="auto");var n="scrollBehavior"in document.body.style;t.forEach((function(t){var o=t.el,r=t.top,i=t.left;o.scroll&&n?o.scroll({top:r,left:i,behavior:e}):(o.scrollTop=r,o.scrollLeft=i)}))}(et(t,o),o.behavior)}}var rt=function(){return tt||(tt="performance"in window?performance.now.bind(performance):Date.now),tt()};function it(t){var e=rt(),n=Math.min((e-t.startTime)/t.duration,1),o=t.ease(n),r=t.startX+(t.x-t.startX)*o,i=t.startY+(t.y-t.startY)*o;t.method(r,i),r!==t.x||i!==t.y?requestAnimationFrame((function(){return it(t)})):t.cb()}function lt(t,e,n,o,r,i){var l,a,c,u;void 0===o&&(o=600),void 0===r&&(r=function(t){return 1+--t*t*t*t*t}),l=t,a=t.scrollLeft,c=t.scrollTop,u=function(e,n){t.scrollLeft=Math.ceil(e),t.scrollTop=Math.ceil(n)},it({scrollable:l,method:u,startTime:rt(),startX:a,startY:c,x:e,y:n,duration:o,ease:r,cb:i})}var at=function(t,e){var n=e||{};return function(t){return t&&!t.behavior||"smooth"===t.behavior}(n)?ot(t,{block:n.block,inline:n.inline,scrollMode:n.scrollMode,boundary:n.boundary,behavior:function(t){return Promise.all(t.reduce((function(t,e){var o=e.el,r=e.left,i=e.top,l=o.scrollLeft,a=o.scrollTop;return l===r&&a===i?t:[].concat(t,[new Promise((function(t){return lt(o,r,i,n.duration,n.ease,(function(){return t({el:o,left:[l,r],top:[a,i]})}))}))])}),[]))}}):Promise.resolve(ot(t,e))};const ct=Symbol("PizzaAnchor");var ut=e({name:"Anchor",props:{showRail:{type:Boolean,default:!0},showBackground:{type:Boolean,default:!0},size:{type:String,default:"default"},smooth:{type:Boolean,default:!0},offsetTarget:{type:[String,Object]}},emits:{select:(t,e)=>!0},setup(t,{emit:e}){const c=x("anchor"),u=n(""),f=n(!1),s=o({}),d=n(),v=n(),h=e=>{const n=G(e);if(!n)return;f.value=!0;const o=t.smooth?"smooth":"auto";at(n,{block:"start",behavior:o}).then((()=>{f.value=!1}))},p=t=>{t!==u.value&&(u.value=t)},m=U((()=>{if(f.value)return;const t=(()=>{if(!d.value)return;const t=d.value.getBoundingClientRect();for(const e of Object.keys(s)){const n=G(e);if(n){const{top:e}=n.getBoundingClientRect(),o=d.value===document.documentElement?e:e-t.top;if(o>=-5&&o<=t.height/2)return n}}})();if(t&&t.id){const e=`#${t.id}`;p(e)}}));return r(u,(()=>{const e=s[u.value];t.showRail&&e&&v.value&&(v.value.style.top=`${e.firstElementChild.offsetTop}px`,v.value.style.height=`${e.firstElementChild.offsetHeight}px`)})),i((()=>{t.offsetTarget?d.value=G(t.offsetTarget):d.value=document.documentElement;const e=decodeURIComponent(window.location.hash);e?(h(e),p(e)):m(),d.value&&document.addEventListener("scroll",m,!0)})),l((()=>{d.value&&document.removeEventListener("scroll",m,!0)})),a(ct,o({currentLink:u,showRail:t.showRail,handleClick:(t,n)=>{n&&(h(n),p(n)),e("select",n,u.value)},addLink:(t,e)=>{t&&(s[t]=e)}})),{clsPrefix:c,barRef:v,currentLink:u}}});ut.render=function(t,e,n,o,r,i){return c(),u("div",{class:f(`${t.clsPrefix}`)},[t.showRail?(c(),u("div",{key:0,class:f(`${t.clsPrefix}-rail`)},[s("div",{ref:"barRef",class:f([`${t.clsPrefix}-rail-bar`,null!==t.currentLink&&`${t.clsPrefix}-rail-bar--active`])},null,2)],2)):d("v-if",!0),s("ul",{class:f(`${t.clsPrefix}-wrap`)},[v(t.$slots,"default")],2)],2)},ut.__file="components/anchor/src/anchor.vue";var ft=e({name:"AnchorLink",props:{title:String,href:String},setup(e){const o=`${x("anchor")}-link`,r=n(),l=t(ct,void 0);i((()=>{e.href&&r.value&&l?.addLink(e.href,r.value)}));return{linkCls:o,context:l,linkRef:r,handleClick:t=>l?.handleClick(t,e.href)}}});const st=["href"];ft.render=function(t,e,n,o,r,i){return c(),u("li",{ref:"linkRef",class:f(`${t.linkCls}-item`)},[s("a",{href:t.href,class:f([t.linkCls,{[`${t.linkCls}-active-line`]:t.context?.currentLink===t.href&&t.context?.showRail,[`${t.linkCls}-active`]:t.context?.currentLink===t.href&&!t.context?.showRail}]),onClick:e[0]||(e[0]=(...e)=>t.handleClick&&t.handleClick(...e))},h(t.title),11,st),v(t.$slots,"default")],2)},ft.__file="components/anchor/src/anchor-link.vue";const dt=w(ut),vt=w(ft);var ht=e({name:"Affix",props:{offsetTop:{type:Number,default:0},offsetBottom:{type:Number},scrollTarget:{type:[String,Object,Function]},position:{type:String,default:"fixed"}},setup(t){const e=x("affix"),o=n(),r=n(),a=n(),c=n(!1),u=U((()=>{if(!o.value)return;const{offsetTop:e,offsetBottom:n,position:i}=t,l=void 0===n?"top":"bottom";const c=o.value.getBoundingClientRect(),u=r.value instanceof HTMLElement?r.value.getBoundingClientRect():{top:0,bottom:window.innerHeight},f="absolute"===i?"absolute":"fixed";let s=!1,d={};const v={width:`${o.value.offsetWidth}px`,height:`${o.value.offsetHeight}px`};"top"===l?(s=c.top-u.top<(e||0),d=s?{position:f,top:"fixed"===f?`${u.top+(e||0)}px`:`${e||0}px`}:{}):(s=u.bottom-c.bottom<(n||0),d=s?{position:f,bottom:"fixed"===f?`${window.innerHeight-u.bottom+(n||0)}px`:`${n||0}px`}:{}),a.value={...d,...s?v:{}}}),200);return i((()=>{(()=>{const{scrollTarget:e}=t;r.value=e&&e!==document&&G(e)||document,r.value&&(r.value.addEventListener("scroll",u),u())})()})),l((()=>{r.value&&r.value.removeEventListener("scroll",u)})),{clsPrefix:e,affixRef:o,fixedStyles:a,fixedStatus:c}}});const pt={ref:"affixRef"};ht.render=function(t,e,n,o,r,i){return c(),u("div",pt,[s("div",{style:p(t.fixedStyles),class:f(t.clsPrefix)},[v(t.$slots,"default")],6)],512)},ht.__file="components/affix/src/affix.vue";const mt=w(ht);var gt=e({name:"ConfigProvider",props:{mode:{type:String,default:"light"},global:{type:Boolean,default:!1},clsPrefix:{type:String,default:"p"}},setup(t){const e=o(m(t));if(t.global){const t=g();t&&t.appContext.app.provide(b,e)}else a(b,e)}});gt.render=function(t,e,n,o,r,i){return v(t.$slots,"default")},gt.__file="components/config-provider/src/config-provider.vue";const bt=w(gt);var yt=Object.freeze({__proto__:null,PAnchor:dt,PAnchorLink:vt,PAffix:mt,PConfigProvider:bt});const xt=t=>{for(const e of Object.keys(yt)){const n=e;t.use(yt[n])}};export{mt as PAffix,dt as PAnchor,xt as default,y as useConfig};
